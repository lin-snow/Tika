import{am as f,ag as g,r as p,M as m,ao as a}from"./CkC02aX9.js";function u(){const e=f("notifications",()=>[]);function r(n){const t={id:new Date().getTime().toString(),...n};return e.value.findIndex(l=>l.id===t.id)===-1&&e.value.push(t),t}function s(n){e.value=e.value.filter(t=>t.id!==n)}function c(n,t){const i=e.value.findIndex(l=>l.id===n);if(i!==-1){const l=e.value[i];e.value.splice(i,1,{...l,...t})}}function o(){e.value=[]}return{add:r,remove:s,update:c,clear:o}}const d=g("authStore",()=>{const e=p(null);if(typeof window<"u"){const t=localStorage.getItem("user");t&&(e.value=JSON.parse(t))}return m(()=>{typeof window<"u"&&(e.value?localStorage.setItem("user",JSON.stringify(e.value)):localStorage.removeItem("user"))}),{user:e,getUser:()=>e.value,getToken:()=>{var t;return((t=e.value)==null?void 0:t.token)||null},isAuthenticated:()=>!!e.value,setUser:t=>{e.value=t,localStorage.setItem("user",JSON.stringify(t))},clearUser:()=>{e.value=null,localStorage.removeItem("user")}}}),S=async(e,r)=>{const s=a().public.baseApi,c=u();try{const o=await $fetch(`${s}/${e}`,{method:"POST",headers:{"Content-Type":"application/json",token:d().getToken()||""},body:JSON.stringify(r)});return o.code!==1?(console.log(o.msg),c.add({title:"请求失败",description:o.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):o}catch(o){console.error(o)}},y=async(e,r)=>{const s=d(),c=a().public.baseApi,o=u();try{if(!s.getToken()||s.getToken()==="")return console.log("No token"),null;const n=r?"?"+Object.keys(r).map(i=>i+"="+r[i]).join("&"):"",t=await $fetch(`${c}/${e}${n}`,{method:"GET",headers:{token:s.getToken()||""}});return t.code!==1?(console.log(t.msg),o.add({title:"请求失败",description:t.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):t}catch(n){console.error(n)}},v=async(e,r)=>{const s=a().public.baseApi,c=u();try{const o=await $fetch(`${s}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",token:d().getToken()||""},body:JSON.stringify(r)});return o.code!==1?(console.log(o.msg),c.add({title:"请求失败",description:o.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):o}catch(o){console.error(o)}},T=async(e,r)=>{const s=a().public.baseApi,c=u();try{const o=r?"?"+Object.keys(r).map(t=>t+"="+r[t]).join("&"):"",n=await $fetch(`${s}/${e}${o}`,{method:"DELETE",headers:{token:d().getToken()||""}});return n.code!==1?(console.log(n.msg),c.add({title:"请求失败",description:n.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):n}catch(o){console.error(o)}};export{u as a,v as b,T as d,y as g,S as p,d as u};
