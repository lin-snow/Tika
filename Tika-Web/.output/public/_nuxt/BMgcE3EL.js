import{_ as I,o as s,c as R,w as i,a as p,b as c,d as t,e as G,f as O,m as D,g as _,h as B,u as E,t as F,i as H,j as U,r as L,k as M,p as J,l as n,n as g,q as k,s as w,v as $,F as v,x as V,y as S,z as K,A as Q,B as N,C as W,D as X}from"./CkC02aX9.js";import{_ as Y,a as Z,N as x}from"./SZOcU6H1.js";import{u as ee,a as re,p as T}from"./BqHsLyaQ.js";const te={wrapper:"",inner:"",label:{wrapper:"flex content-center items-center justify-between",base:"block font-medium text-gray-700 dark:text-gray-200",required:"after:content-['*'] after:ms-0.5 after:text-red-500 dark:after:text-red-400"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},container:"mt-1 relative",description:"text-gray-500 dark:text-gray-400",hint:"text-gray-500 dark:text-gray-400",help:"mt-2 text-gray-500 dark:text-gray-400",error:"mt-2 text-red-500 dark:text-red-400",default:{size:"sm"}},se={},oe={class:"flex justify-between items-center"};function ae(e,l){const d=G,o=O;return s(),R(o,{class:"mx-auto mt-4 max-w-sm"},{default:i(()=>[p("div",oe,[l[1]||(l[1]=p("div",{class:"text-2xl text"},[c(" 欢迎使用 "),p("span",{style:{color:"rgb(0 193 106)"},class:"text-2xl italic font-bold"}," Tika ")],-1)),p("div",null,[t(d,{to:"/",variant:"solid",color:"gray",size:"md",icon:"i-fluent-home-12-regular"},{default:i(()=>l[0]||(l[0]=[c(" 首页 ")])),_:1})])])]),_:1})}const ne=I(se,[["render",ae]]),j=D(_.ui.strategy,_.ui.formGroup,te),le=B({inheritAttrs:!1,props:{name:{type:String,default:null},size:{type:String,default:null,validator(e){return Object.keys(j.size).includes(e)}},label:{type:String,default:null},description:{type:String,default:null},required:{type:Boolean,default:!1},help:{type:String,default:null},error:{type:[String,Boolean],default:null},hint:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},eagerValidation:{type:Boolean,default:!1}},setup(e){const{ui:l,attrs:d}=E("formGroup",F(e,"ui"),j,F(e,"class")),o=H("form-errors",null),u=U(()=>{var a,m;return e.error&&typeof e.error=="string"||typeof e.error=="boolean"?e.error:(m=(a=o==null?void 0:o.value)==null?void 0:a.find(r=>r.path===e.name))==null?void 0:m.message}),z=U(()=>l.value.size[e.size??j.default.size]),f=L(M());return J("form-group",{error:u,inputId:f,name:U(()=>e.name),size:U(()=>e.size),eagerValidation:U(()=>e.eagerValidation)}),{ui:l,attrs:d,inputId:f,size:z,error:u}}}),ie=["for"];function ue(e,l,d,o,u,z){return s(),n("div",$({class:e.ui.wrapper},e.attrs),[p("div",{class:g(e.ui.inner)},[e.label||e.$slots.label?(s(),n("div",{key:0,class:g([e.ui.label.wrapper,e.size])},[p("label",{for:e.inputId,class:g([e.ui.label.base,e.required?e.ui.label.required:""])},[e.$slots.label?k(e.$slots,"label",w($({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(s(),n(v,{key:1},[c(V(e.label),1)],64))],10,ie),e.hint||e.$slots.hint?(s(),n("span",{key:0,class:g([e.ui.hint])},[e.$slots.hint?k(e.$slots,"hint",w($({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(s(),n(v,{key:1},[c(V(e.hint),1)],64))],2)):S("",!0)],2)):S("",!0),e.description||e.$slots.description?(s(),n("p",{key:1,class:g([e.ui.description,e.size])},[e.$slots.description?k(e.$slots,"description",w($({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(s(),n(v,{key:1},[c(V(e.description),1)],64))],2)):S("",!0)],2),p("div",{class:g([e.label?e.ui.container:""])},[k(e.$slots,"default",w(K({error:e.error}))),typeof e.error=="string"&&e.error?(s(),n("p",{key:0,class:g([e.ui.error,e.size])},[e.$slots.error?k(e.$slots,"error",w($({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(s(),n(v,{key:1},[c(V(e.error),1)],64))],2)):e.help||e.$slots.help?(s(),n("p",{key:1,class:g([e.ui.help,e.size])},[e.$slots.help?k(e.$slots,"help",w($({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(s(),n(v,{key:1},[c(V(e.help),1)],64))],2)):S("",!0)],2)],16)}const de=I(le,[["render",ue]]),pe=()=>{const e=ee(),l=Q(),d=re();return{login:async f=>{try{const a=await T("user/login",f);if(!a)throw new Error("Login request failed");const{id:m,username:r,token:h}=a.data,b={id:m,username:r,token:h};e.setUser(b),console.log("登录成功"),d.add({title:"登录成功",description:"欢迎回来",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),l.push("/")}catch(a){console.error(a)}},register:async f=>{try{const a=await T("user/register",f);if(!a)throw new Error("Register request failed");return console.log("注册成功"),d.add({title:"注册成功",description:"欢迎使用Tika,请登录使用",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:5e3}),a}catch(a){console.error(a)}},logout:()=>{e.clearUser()}}},me={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},ce={key:0,class:"space-y-3"},fe={class:"flex justify-center"},ye={key:1,class:"space-y-3"},ge={class:"flex justify-center"},he=B({__name:"AuthTabs",setup(e){const{login:l,register:d}=pe(),o=N({username:"",password:""}),u=N({username:"",password:""}),z=[{key:"login",label:"登录",description:"请输入账号密码登录"},{key:"register",label:"注册",description:"创建一个新账户"}],f=m=>{u.username="",u.password=""},a=async m=>{try{m==="login"?await l(o):m==="register"&&await d(u)&&f("register")}catch(r){console.error(r)}};return(m,r)=>{const h=Y,b=de,C=G,A=O,P=Z;return s(),R(A,{class:"mx-auto mt-4 max-w-sm"},{default:i(()=>[t(P,{items:z,class:"w-full"},{item:i(({item:q})=>[t(A,{onSubmit:W(y=>a(q.key),["prevent"])},{header:i(()=>[p("p",me,V(q.description),1)]),default:i(()=>[q.key==="login"?(s(),n("div",ce,[t(b,{label:"用户名",required:""},{default:i(()=>[t(h,{modelValue:o.username,"onUpdate:modelValue":r[0]||(r[0]=y=>o.username=y),type:"text",placeholder:"输入用户名",color:"gray"},null,8,["modelValue"])]),_:1}),t(b,{label:"密码",required:""},{default:i(()=>[t(h,{modelValue:o.password,"onUpdate:modelValue":r[1]||(r[1]=y=>o.password=y),type:"password",placeholder:"输入密码",color:"gray"},null,8,["modelValue"])]),_:1}),p("div",fe,[t(C,{type:"submit",variant:"solid",color:"gray",icon:"i-fluent-drink-24-regular",class:"w-28 flex justify-center items-center"},{default:i(()=>r[4]||(r[4]=[c(" 登录 ")])),_:1})])])):q.key==="register"?(s(),n("div",ye,[t(b,{label:"用户名",required:""},{default:i(()=>[t(h,{modelValue:u.username,"onUpdate:modelValue":r[2]||(r[2]=y=>u.username=y),type:"text",placeholder:"输入用户名",color:"gray"},null,8,["modelValue"])]),_:1}),t(b,{label:"密码",required:""},{default:i(()=>[t(h,{modelValue:u.password,"onUpdate:modelValue":r[3]||(r[3]=y=>u.password=y),type:"password",placeholder:"输入密码",color:"gray"},null,8,["modelValue"])]),_:1}),p("div",ge,[t(C,{type:"submit",variant:"solid",color:"gray",class:"w-28 flex justify-center items-center",icon:"i-fluent-person-add-16-regular"},{default:i(()=>r[5]||(r[5]=[c(" 注册 ")])),_:1})])])):S("",!0)]),_:2},1032,["onSubmit"])]),_:1})]),_:1})}}}),$e=B({__name:"auth",setup(e){return(l,d)=>{const o=X;return s(),n(v,null,[t(o,{class:"py-2 pb-4"},{default:i(()=>[t(ne),t(he)]),_:1}),t(x)],64)}}});export{$e as default};
